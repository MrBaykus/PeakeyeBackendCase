using PeakeyeBackendCase.Helpers;
using System.ComponentModel.DataAnnotations;

namespace PeakeyeBackendCase.Models
{
    public class Vulnerability
    {
        public int Id { get; set; }
        [Required(ErrorMessage = "Name alanı boş olamaz.")]
        public string Name { get; set; }
        public string Description { get; set; }
        [Required(ErrorMessage = "Severity alanı boş olamaz.")]
        [RegularExpression("Low|Medium|High|Critical", ErrorMessage = "Severity yalnızca Low, Medium, High, Critical olabilir.")]
        public string Severity { get; set; }
        public double CVSS { get; set; }

        public double Calculate()
        {
            return CvssCalculator.Calculate(
                AccessVector,
                AccessComplexity,
                Authentication,
                ConfidentialityImpact,
                IntegrityImpact,
                AvailabilityImpact
            );
        }

        public string CVE { get; set; }
        [Required(ErrorMessage = "Status alanı boş olamaz.")]
        [RegularExpression("Open|Closed", ErrorMessage = "Status yalnızca Open veya Closed olabilir.")]
        public string Status { get; set; }
        [RegularExpression("Local|Adjacent|Network", ErrorMessage = "AccessVector yalnızca Local,Adjacent,Network olabilir.")]
        public string AccessVector { get; set; } = "Network";
        [RegularExpression("Low|Medium|High", ErrorMessage = "Acces Complexity yalnızca Low, Medium, High olabilir.")]
        public string AccessComplexity { get; set; } = "Low";
        [RegularExpression("None|Single|Multiple", ErrorMessage = "Authentication yalnızca None, Single, Multiple olabilir.")]
        public string Authentication { get; set; } = "None";
        [RegularExpression("None|Partial|Complete", ErrorMessage = "Confidentiality Impact yalnızca None, Partial, Complete olabilir.")]
        public string ConfidentialityImpact { get; set; } = "Complete";
        [RegularExpression("None|Partial|Complete", ErrorMessage = "Integrity Impact yalnızca None, Partial, Complete olabilir.")]
        public string IntegrityImpact { get; set; } = "Complete";
        [RegularExpression("None|Partial|Complete", ErrorMessage = "Availability Impact yalnızca None, Partial, Complete olabilir.")]
        public string AvailabilityImpact { get; set; } = "Partial";

    }
}
